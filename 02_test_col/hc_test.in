###############################################
###
### This file is generated by txpp. Do not edit.
###
### Input file : D:\001_zerlingx\literature\HC\006_models\02_hc_test\hc_test.pre
### Output file: D:\001_zerlingx\literature\HC\006_models\02_hc_test\hc_test.in
### Translation: Fri, 14 Dec 2018 20:55:37
###
###############################################

nsteps = 4000
dumpPeriodicity = 500
dt = 1e-12
dimension = 2
floattype = double
verbosity = 127
copyHistoryAtEachDump = 0
useGridBndryRestore = True
constructUniverse = False

<Grid globalGrid>
  verbosity = 127
  numCells = [400  480  12]
  lengths = [0.005 0.006 1.0]
  startPositions = [-0.0025 -0.0005 0.0]
  maxCellXings = 1
</Grid>

<Decomp decomp>
  periodicDirs = []
</Decomp>

<EmMaterial PEC>
  kind = conductor
  resistance = 0.0
</EmMaterial>

<GridBoundary hc_testPecShapes>
  kind = gridRgnBndry
  calculateVolume = 1
  dmFrac = 0.4
  polyfilename = hc_testPecShapes.stl
  flipInterior = True
  scale = [1.0  1.0  1.0]
  printGridData = False
  mappedPolysfile = hc_testPecShapes_mapped.stl
</GridBoundary>

<GridBoundary Anode>
  kind = gridRgnBndry
  calculateVolume = 1
  dmFrac = 0.4
  polyfilename = Anode.stl
  flipInterior = True
  scale = [1.0  1.0  1.0]
  printGridData = False
  mappedPolysfile = Anode_mapped.stl
</GridBoundary>

<GridBoundary Cathode>
  kind = gridRgnBndry
  calculateVolume = 1
  dmFrac = 0.4
  polyfilename = Cathode.stl
  flipInterior = True
  scale = [1.0  1.0  1.0]
  printGridData = False
  mappedPolysfile = Cathode_mapped.stl
</GridBoundary>

<GridBoundary GrateArray-GrateGeomSolid>
  kind = gridRgnBndry
  calculateVolume = 1
  dmFrac = 0.4
  polyfilename = GrateArray-GrateGeomSolid.stl
  flipInterior = True
  scale = [1.0  1.0  1.0]
  printGridData = False
  mappedPolysfile = GrateArray-GrateGeomSolid_mapped.stl
</GridBoundary>

<MultiField esMultiField>

  <Field E>
    numComponents = 3
    offset = edge
    kind = regular
    overlap = [1 1]
    labels = [E_x   E_y   E_z]
  </Field>

  <Field nodalE>
    numComponents = 3
    offset = none
    kind = regular
    overlap = [1 2]
    labels = [nodalE_x   nodalE_y   nodalE_z]
  </Field>

  <Field nodalB>
    numComponents = 3
    offset = none
    kind = regular
    overlap = [1 2]
    labels = [nodalB_x   nodalB_y   nodalB_z]
  </Field>

  <Field Phi>
    numComponents = 1
    offset = none
    kind = regular
    overlap = [1 2]
    labels = [Phi]
  </Field>

  <Field ChargeDensity>
    numComponents = 1
    offset = none
    kind = depField
    overlap = [1 2]
    labels = [ChargeDensity]
  </Field>

  <FieldUpdater gradPhi>
    kind = gradVecUpdater
    factor = -1.0
    lowerBounds = [0  0  0]
    upperBounds = [400   480   12]
    readFields = [Phi]
    writeFields = [E]
  </FieldUpdater>

  <FieldUpdater edgeToNode>
    kind = edgeToNodeVec
    lowerBounds = [0  0  0]
    upperBounds = [401  481  13]
    readFields = [E]
    writeFields = [nodalE]
  </FieldUpdater>

  <FieldUpdater copyPerimlowerX>
    kind = unaryFieldOpUpdater
    minDim = 1
    lowerBounds = [0  0  0]
    upperBounds = [1  481  13]
    operation = set
    bumpReadIter = [0  0  0]
    readFields = [E]
    component = 0
    writeFields = [nodalE]

    <STFunc copyFunc>
      kind = constantFunc
      amplitude = 1.
    </STFunc>

  </FieldUpdater>

  <FieldUpdater copyPerimupperX>
    kind = unaryFieldOpUpdater
    minDim = 1
    lowerBounds = [400  0  0]
    upperBounds = [401  481  13]
    operation = set
    bumpReadIter = [-1  0  0]
    readFields = [E]
    component = 0
    writeFields = [nodalE]

    <STFunc copyFunc>
      kind = constantFunc
      amplitude = 1.
    </STFunc>

  </FieldUpdater>

  <FieldUpdater copyPerimlowerY>
    kind = unaryFieldOpUpdater
    minDim = 2
    lowerBounds = [0  0  0]
    upperBounds = [401  1  13]
    operation = set
    bumpReadIter = [0  0  0]
    readFields = [E]
    component = 1
    writeFields = [nodalE]

    <STFunc copyFunc>
      kind = constantFunc
      amplitude = 1.
    </STFunc>

  </FieldUpdater>

  <FieldUpdater copyPerimupperY>
    kind = unaryFieldOpUpdater
    minDim = 2
    lowerBounds = [0  480  0]
    upperBounds = [401  481  13]
    operation = set
    bumpReadIter = [0  -1  0]
    readFields = [E]
    component = 1
    writeFields = [nodalE]

    <STFunc copyFunc>
      kind = constantFunc
      amplitude = 1.
    </STFunc>

  </FieldUpdater>

  <InitialUpdateStep esSolveInitialUpdateStep>
    alsoAfterRestore = True
    updaters = [esSolve]
    messageFields = [Phi]
  </InitialUpdateStep>

  <InitialUpdateStep edgeToNodeInitStep>
    alsoAfterRestore = True
    updaters = [edgeToNode]
    messageFields = [Phi]
  </InitialUpdateStep>

  <InitialUpdateStep gradPhiInitStep>
    alsoAfterRestore = True
    updaters = [gradPhi]
    messageFields = [E]
  </InitialUpdateStep>

  <UpdateStep esSolveStep>
    toDtFrac = 1.0
    updaters = [esSolve]
    messageFields = [Phi]
  </UpdateStep>

  <UpdateStep gradPhiStep>
    toDtFrac = 1.0
    updaters = [gradPhi]
    messageFields = [E]
  </UpdateStep>

  <UpdateStep edgeToNodeStep>
    toDtFrac = 1.0
    updaters = [edgeToNode]
    messageFields = [nodalE]
  </UpdateStep>

  <UpdateStep copyPerimlowerXStep>
    toDtFrac = 1.0
    updaters = [copyPerimlowerX]
    messageFields = [nodalE]
  </UpdateStep>

  <UpdateStep copyPerimupperXStep>
    toDtFrac = 1.0
    updaters = [copyPerimupperX]
    messageFields = [nodalE]
  </UpdateStep>

  <UpdateStep copyPerimlowerYStep>
    toDtFrac = 1.0
    updaters = [copyPerimlowerY]
    messageFields = [nodalE]
  </UpdateStep>

  <UpdateStep copyPerimupperYStep>
    toDtFrac = 1.0
    updaters = [copyPerimupperY]
    messageFields = [nodalE]
  </UpdateStep>

  <FieldUpdater esSolve>
    kind = linearSolveUpdater
    lowerBounds = [0  0]
    upperBounds = [401  481]
    readFields = [ChargeDensity]
    readComponents = [0]
    writeFields = [Phi]
    writeComponents = [0]
    writeEquationToFile = 0

    <MatrixFiller interiorFiller>
      kind = nodeStencilFiller
      gridBoundary = hc_testPecShapes
      rowInteriorosity = [insideBoundary]
      colInteriorosity = [insideBoundary cutByBoundary outsideBoundary]
      component = 0
      minDim = 1
      lowerBounds = [1  1  1]
      upperBounds = [400   480   12]

      <StencilElement lap_dd>
        value = 0.22666720813108196
        minDim = 0
        cellOffset = [0 0 0]
        rowFieldIndex = 0
        columnFieldIndex = 0
      </StencilElement>

      <StencilElement lap_px>
        value = -0.05666680203277049
        minDim = 1
        cellOffset = [1 0 0]
        rowFieldIndex = 0
        columnFieldIndex = 0
      </StencilElement>

      <StencilElement lap_mx>
        value = -0.05666680203277049
        minDim = 1
        cellOffset = [-1 0 0]
        rowFieldIndex = 0
        columnFieldIndex = 0
      </StencilElement>

      <StencilElement lap_py>
        value = -0.05666680203277049
        minDim = 2
        cellOffset = [0 1 0]
        rowFieldIndex = 0
        columnFieldIndex = 0
      </StencilElement>

      <StencilElement lap_my>
        value = -0.05666680203277049
        minDim = 2
        cellOffset = [0 -1 0]
        rowFieldIndex = 0
        columnFieldIndex = 0
      </StencilElement>

      <StencilElement lap_pz>
        value = 0
        minDim = 3
        cellOffset = [0 0 1]
        rowFieldIndex = 0
        columnFieldIndex = 0
      </StencilElement>

      <StencilElement lap_mz>
        value = 0
        minDim = 3
        cellOffset = [0 0 -1]
        rowFieldIndex = 0
        columnFieldIndex = 0
      </StencilElement>

    </MatrixFiller>

    <VectorWriter interiorWriter>
      kind = nodeFieldVectorWriter
      gridBoundary = hc_testPecShapes
      interiorosity = [insideBoundary]
      minDim = 1
      readField = ChargeDensity
      readComponent = 0
      lowerBounds = [1  1  1]
      upperBounds = [400   480   12]
      component = 0
    </VectorWriter>

    <VectorReader phiReader>
      kind = fieldVectorReader
      minDim = 0
      writeField = Phi
      writeComponent = 0
      lowerBounds = [0  0]
      upperBounds = [401  481]
      componentBounds = [0 1]
    </VectorReader>

    <MatrixFiller AnodeVFiller>
      kind = nodeStencilFiller
      gridBoundary = Anode
      rowInteriorosity = [cutByBoundary outsideBoundary]
      colInteriorosity = [cutByBoundary outsideBoundary]
      component = 0
      minDim = 1
      lowerBounds = [1  1  1]
      upperBounds = [400   480   12]

      <StencilElement ident>
        value = 0.22666720813108196
        minDim = 1
        cellOffset = [0 0 0]
        rowFieldIndex = 0
        columnFieldIndex = 0
      </StencilElement>

    </MatrixFiller>

    <VectorWriter AnodeVWriter>
      kind = stFuncNodeVectorWriter
      gridBoundary = Anode
      minDim = 1
      lowerBounds = [1  1  1]
      upperBounds = [400   480   12]
      component = 0
      interiorosity = [cutByBoundary outsideBoundary]

      <STFunc function>
        kind = expression
        expression = 300.0
      </STFunc>

      scaling = 0.22666720813108196
    </VectorWriter>

    <MatrixFiller GrateVFiller>
      kind = nodeStencilFiller
      gridBoundary = GrateArray-GrateGeomSolid
      rowInteriorosity = [cutByBoundary outsideBoundary]
      colInteriorosity = [cutByBoundary outsideBoundary]
      component = 0
      minDim = 1
      lowerBounds = [1  1  1]
      upperBounds = [400   480   12]

      <StencilElement ident>
        value = 0.22666720813108196
        minDim = 1
        cellOffset = [0 0 0]
        rowFieldIndex = 0
        columnFieldIndex = 0
      </StencilElement>

    </MatrixFiller>

    <VectorWriter GrateVWriter>
      kind = stFuncNodeVectorWriter
      gridBoundary = GrateArray-GrateGeomSolid
      minDim = 1
      lowerBounds = [1  1  1]
      upperBounds = [400   480   12]
      component = 0
      interiorosity = [cutByBoundary outsideBoundary]

      <STFunc function>
        kind = expression
        expression = (4.0*sin(6283185307.179586*t)+10.0)
      </STFunc>

      scaling = 0.22666720813108196
    </VectorWriter>

    <MatrixFiller CathodeVFiller>
      kind = nodeStencilFiller
      gridBoundary = Cathode
      rowInteriorosity = [cutByBoundary outsideBoundary]
      colInteriorosity = [cutByBoundary outsideBoundary]
      component = 0
      minDim = 1
      lowerBounds = [1  1  1]
      upperBounds = [400   480   12]

      <StencilElement ident>
        value = 0.22666720813108196
        minDim = 1
        cellOffset = [0 0 0]
        rowFieldIndex = 0
        columnFieldIndex = 0
      </StencilElement>

    </MatrixFiller>

    <VectorWriter CathodeVWriter>
      kind = stFuncNodeVectorWriter
      gridBoundary = Cathode
      minDim = 1
      lowerBounds = [1  1  1]
      upperBounds = [400   480   12]
      component = 0
      interiorosity = [cutByBoundary outsideBoundary]

      <STFunc function>
        kind = expression
        expression = 0.0
      </STFunc>

      scaling = 0.22666720813108196
    </VectorWriter>

    <MatrixFiller LowerXFiller>
      kind = stencilFiller
      verbosity = 127
      minDim = 1
      lowerBounds = [0  0  0]
      upperBounds = [1  481  13]
      component = 0

      <StencilElement diag>
        value = -0.22666720813108196
        minDim = 0
        cellOffset = [0  0  0]
        rowFieldIndex = 0
        columnFieldIndex = 0
      </StencilElement>

      <StencilElement xoff>
        value = 0.22666720813108196
        minDim = 1
        cellOffset = [1  0  0]
        rowFieldIndex = 0
        columnFieldIndex = 0
      </StencilElement>

    </MatrixFiller>

    <VectorWriter LowerXWriter>
      kind = stFuncVectorWriter
      verbosity = 127
      minDim = 1
      lowerBounds = [0  0  0]
      upperBounds = [1  481  13]
      component = 0

      <STFunc function>
        kind = expression
        expression = 0.0
      </STFunc>

      scaling = 2.8333401016385245e-06
    </VectorWriter>

    <MatrixFiller UpperXFiller>
      kind = stencilFiller
      verbosity = 127
      minDim = 1
      lowerBounds = [400  0  0]
      upperBounds = [401  481  13]
      component = 0

      <StencilElement diag>
        value = 0.22666720813108196
        minDim = 0
        cellOffset = [0  0  0]
        rowFieldIndex = 0
        columnFieldIndex = 0
      </StencilElement>

      <StencilElement xoff>
        value = -0.22666720813108196
        minDim = 1
        cellOffset = [-1  0  0]
        rowFieldIndex = 0
        columnFieldIndex = 0
      </StencilElement>

    </MatrixFiller>

    <VectorWriter UpperXWriter>
      kind = stFuncVectorWriter
      verbosity = 127
      minDim = 1
      lowerBounds = [400  0  0]
      upperBounds = [401  481  13]
      component = 0

      <STFunc function>
        kind = expression
        expression = -0.0
      </STFunc>

      scaling = 2.8333401016385245e-06
    </VectorWriter>

    <MatrixFiller LowerYFiller>
      kind = stencilFiller
      verbosity = 127
      minDim = 2
      lowerBounds = [1  0  0]
      upperBounds = [400  1  13]
      component = 0

      <StencilElement ident>
        value = 0.22666720813108196
        minDim = 0
        cellOffset = [0  0  0]
        rowFieldIndex = 0
        columnFieldIndex = 0
      </StencilElement>

    </MatrixFiller>

    <VectorWriter LowerYWriter>
      kind = stFuncVectorWriter
      verbosity = 127
      minDim = 2
      lowerBounds = [1  0  0]
      upperBounds = [400  1  13]
      component = 0

      <STFunc function>
        kind = expression
        expression = 0.0
      </STFunc>

      scaling = 0.22666720813108196
    </VectorWriter>

    <MatrixFiller UpperYFiller>
      kind = stencilFiller
      verbosity = 127
      minDim = 2
      lowerBounds = [1  480  0]
      upperBounds = [400  481  13]
      component = 0

      <StencilElement ident>
        value = 0.22666720813108196
        minDim = 0
        cellOffset = [0  0  0]
        rowFieldIndex = 0
        columnFieldIndex = 0
      </StencilElement>

    </MatrixFiller>

    <VectorWriter UpperYWriter>
      kind = stFuncVectorWriter
      verbosity = 127
      minDim = 2
      lowerBounds = [1  480  0]
      upperBounds = [400  481  13]
      component = 0

      <STFunc function>
        kind = expression
        expression = 300.0
      </STFunc>

      scaling = 0.22666720813108196
    </VectorWriter>

    <LinearSolver linearSolver>
      kind = iterativeSolver
      verbosity = 127
      maxIterations = 1000
      tolerance = 1e-08
      convergenceMetric = r0

      <BaseSolver myBS>
        kind = gmres
        kspace = 30
        orthog = classic
      </BaseSolver>

      <Preconditioner precond>
        kind = multigrid
        mgOutput = 0
        mgDefaults = DD
        maxLevels = 10
        smootherType = GaussSeidel
        smootherSweeps = 3
        smootherPrePost = both
        coarseType = Jacobi
        dampingFactor = 1.333
        threshold = 0.0
        increaseDecrease = increasing
      </Preconditioner>

    </LinearSolver>

  </FieldUpdater>

  updateStepOrder = [esSolveStep gradPhiStep edgeToNodeStep copyPerimlowerXStep copyPerimupperXStep copyPerimlowerYStep copyPerimupperYStep]
</MultiField>

<ScalarDepositor ChargeDensityDep>
  kind = areaWeighting
  depField = esMultiField.ChargeDensity
</ScalarDepositor>

<Species electrons0>
  kind = relBorisVW
  charge = -1.602176487e-19
  mass = 9.10938215e-31
  maxcellxing = 1
  nominalDensity = 1000000000000.0
  nomPtclsPerCell = 1.0
  fields = [esMultiField.nodalE esMultiField.nodalB]
  chargeDeps = [ChargeDensityDep]

  <ParticleSource myemit>
    kind = xvLoaderEmitter
    applyTimes = [0.0 1.0]
    load = False
    loadAfterInit = False
    loadOnShift = False
    emit = True
    emitBasedOnLocalForce = 0
    useCornerMove = 1

    <VelocityGenerator velGen>
      kind = fieldEmitterVelGen
      velocityIsLocal = 1
      work_function = 14.0
      temperature = 700.0
      alpha = 0.1
      field_enhancement = 1.0
      multiplier = 1.0
      emitterType = Richardson-Dushman
    </VelocityGenerator>

    <STFunc relMacroFluxFunc>
      kind = expression
      expression = (H(1.5e-3-abs(x)))
    </STFunc>

    <PositionGenerator posGen>
      kind = cutCellPosGen
      emitterBoundary = Cathode
      emissionOffset = 0.1
      nomMacroPtclsPerStep = 1000.0
    </PositionGenerator>

  </ParticleSource>

  <ParticleSink lower0Absorber>
    kind = absorber
    minDim = 1
    lowerBounds = [-1   -1   -1]
    upperBounds = [0   481   13]
  </ParticleSink>

  <ParticleSink upper0Absorber>
    kind = absorber
    minDim = 1
    lowerBounds = [400   -1   -1]
    upperBounds = [401   481   13]
  </ParticleSink>

  <ParticleSink lower1Absorber>
    kind = absorber
    minDim = 2
    lowerBounds = [0   -1   -1]
    upperBounds = [400   0   13]
  </ParticleSink>

  <ParticleSink upper1Absorber>
    kind = absorber
    minDim = 2
    lowerBounds = [0   480   -1]
    upperBounds = [400   481   13]
  </ParticleSink>

  <ParticleSink GrateAbs>
    kind = absSavTriCutCell
    minDim = 1
    gridBoundary = GrateArray-GrateGeomSolid
    lowerBounds = [-1  -1  -1]
    upperBounds = [401  481  13]
  </ParticleSink>

</Species>

<Species Xe_plus1>
  kind = relBorisVW
  charge = 1.602176487e-19
  mass = 2.1801711147789e-25
  ionizationEnergy = 0.0
  maxcellxing = 1
  nominalDensity = 1000000000000.0
  nomPtclsPerCell = 1.0
  fields = [esMultiField.nodalE esMultiField.nodalB]
  chargeDeps = [ChargeDensityDep]

  <ParticleSink lower0Absorber>
    kind = absorber
    minDim = 1
    lowerBounds = [-1   -1   -1]
    upperBounds = [0   481   13]
  </ParticleSink>

  <ParticleSink upper0Absorber>
    kind = absorber
    minDim = 1
    lowerBounds = [400   -1   -1]
    upperBounds = [401   481   13]
  </ParticleSink>

  <ParticleSink lower1Absorber>
    kind = absorber
    minDim = 2
    lowerBounds = [0   -1   -1]
    upperBounds = [400   0   13]
  </ParticleSink>

  <ParticleSink upper1Absorber>
    kind = absorber
    minDim = 2
    lowerBounds = [0   480   -1]
    upperBounds = [400   481   13]
  </ParticleSink>

  <ParticleSink Xe_plus1absSaveCutCell0>
    kind = absSavTriCutCell
    minDim = 1
    gridBoundary = Cathode
    lowerBounds = [-1  -1  -1]
    upperBounds = [401  481  13]
  </ParticleSink>

</Species>

<Species electrons_col>
  kind = relBorisVW
  charge = -1.602176487e-19
  mass = 9.10938215e-31
  maxcellxing = 1
  nominalDensity = 1000000000000.0
  nomPtclsPerCell = 1.0
  fields = [esMultiField.nodalE esMultiField.nodalB]
  chargeDeps = [ChargeDensityDep]

  <ParticleSink lower0Absorber>
    kind = absorber
    minDim = 1
    lowerBounds = [-1   -1   -1]
    upperBounds = [0   481   13]
  </ParticleSink>

  <ParticleSink upper0Absorber>
    kind = absorber
    minDim = 1
    lowerBounds = [400   -1   -1]
    upperBounds = [401   481   13]
  </ParticleSink>

  <ParticleSink lower1Absorber>
    kind = absorber
    minDim = 2
    lowerBounds = [0   -1   -1]
    upperBounds = [400   0   13]
  </ParticleSink>

  <ParticleSink upper1Absorber>
    kind = absorber
    minDim = 2
    lowerBounds = [0   480   -1]
    upperBounds = [400   481   13]
  </ParticleSink>

  <ParticleSink electrons_colabsSaveCutCell1>
    kind = absSavTriCutCell
    minDim = 1
    gridBoundary = GrateArray-GrateGeomSolid
    lowerBounds = [-1  -1  -1]
    upperBounds = [401  481  13]
  </ParticleSink>

</Species>

<Fluid Xe>
  kind = neutralGas
  gasKind = Xe
  particleMass = 2.1801711147789e-25
  charge = 0.
  ionizationEnergy = 12.13
  constantDensity = False

  <InitialCondition initialDensity>
    lowerBounds = [-40  -40  0]
    upperBounds = [200  520  0]
    components = [0]
    kind = varset

    <STFunc component0>
      kind = expression
      expression = 100.0
    </STFunc>

  </InitialCondition>

</Fluid>

<MonteCarloInteractions monteCarloInteractions>

  <IncidentSelector theselecter>
    kind = unbiasedSelector
  </IncidentSelector>

  <Interaction particleFluidImpactIonization0>
    kind = impactIonization
    impactSpecies = electrons0
    ionizedElectronSpecies = electrons_col
    ionSpecies = Xe_plus1
    ionizationThreshold = 12.13
    isNeutralGasFluid = True
    neutralGas = Xe
    neutralGasTemp = 300.0
    depleteBackgroundGas = True
    crossSection = eedl
    crossSectionDataFile = eedl.dat
  </Interaction>

</MonteCarloInteractions>

<History numMacroPtcls0>
  kind = speciesNumberOf
  species = [electrons0]
</History>

<History emittedCurrent0>
  kind = speciesCurrEmit
  species = [electrons0]
  ptclSource = electrons0.myemit
  sourceType = 0
</History>

<History num_Xe_plus1>
  kind = speciesNumberOf
  species = [Xe_plus1]
</History>

<History num_elec_col>
  kind = speciesNumberOf
  species = [electrons_col]
</History>


